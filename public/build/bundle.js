!function(){"use strict";class t{constructor(t){this.isStart=!1,this.entity=t}static getClass(e){return t.nameToComp.get(e)}static registerComponent(t,e){this.nameToComp.set(t,e)}static generateComponent(e){const s=t.nameToComp.get(e);return s?new s:void 0}static getAttributeName(t){for(const e of this.nameToComp.entries())if(e[1]==t)return e[0]}start(){}update(){}onDestroy(){}}t.nameToComp=new Map;class e{constructor(t,e){this.x=t,this.y=e}addVectors(t){return new e(this.x+t.x,this.y+t.y)}multiply(t){return new e(this.x*t,this.y*t)}get normalized(){return this.multiply(1/this.distance)}get distance(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}getDistance(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}static cross(t,e){return t.x*e.y-t.y*e.x}static isCrossXY(t,e,s,n){const o=(s.x-n.x)*(t.y-s.y)+(s.y-n.y)*(s.x-t.x),r=(s.x-n.x)*(e.y-s.y)+(s.y-n.y)*(s.x-e.x);return((t.x-e.x)*(s.y-t.y)+(t.y-e.y)*(t.x-s.x))*((t.x-e.x)*(n.y-t.y)+(t.y-e.y)*(t.x-n.x))<0&&o*r<0}}class s{static destoyRecursive(t){for(let e of t.children)s.destoyRecursive(e);t.remove()}}class n extends HTMLElement{static new(t,e){const s=document.createElement("m-vertex");t.appendChild(s);const o=s.style;switch(o.position="absolute",o.width="0px",o.height="0px",e){case n.TYPE_LT:break;case n.TYPE_RT:o.left="100%";break;case n.TYPE_RB:o.top="100%",o.left="100%";break;case n.TYPE_LB:o.top="100%"}return s}get positionScreen(){const t=this.getBoundingClientRect();return new e(t.x,t.y)}}n.TYPE_LT=0,n.TYPE_RT=1,n.TYPE_RB=2,n.TYPE_LB=3,customElements.define("m-vertex",n);class o extends HTMLElement{constructor(){super(...arguments),this.vertices=[],this.nameToComponent=new Map,this.collides=[],this.notCollides=[],this.bufferVertexPos=[],this.bufferPositionScreen=new e(0,0),this.bufferRadius=0}static generate(){const t=document.createElement("m-entity");return document.body.appendChild(t),t.initializeIfNotYet(),t}static update(){o.calcCollides();for(const t of this.list)0==t.isDestroy?t.update():t.onDestroy()}static calcCollides(){for(const t of o.list)t.collides=[],t.notCollides=[],t.computeBuffer();for(const t of o.list)t.calcCollides()}connectedCallback(){this.initializeIfNotYet()}initializeIfNotYet(){if(0==o.list.includes(this)){o.list.push(this),this.vertices=[n.new(this,n.TYPE_LT),n.new(this,n.TYPE_RT),n.new(this,n.TYPE_RB),n.new(this,n.TYPE_LB)];const t=this.style,e=getComputedStyle(this,null);""==t.getPropertyValue("--x")&&(this.x=0),""==t.getPropertyValue("--y")&&(this.y=0),""==t.getPropertyValue("--rad")&&(this.rad=0),""==t.getPropertyValue("--sx")&&(this.sx=1),""==t.getPropertyValue("--sy")&&(this.sy=1);const s=t.getPropertyValue("--w").replace("px","");this.w=Number(s||e.width.replace("px",""));const r=t.getPropertyValue("--h").replace("px","");this.h=Number(r||e.height.replace("px",""))}}update(){const e=new Map(this.nameToComponent),s=[...this.attributes];for(const n of s){let s=e.get(n.name);if(s)e.delete(n.name);else{const e=t.getClass(n.name);e&&(s=this.addComponent(e),s&&(s.entity=this,this.nameToComponent.set(n.name,s)))}s&&(0==s.isStart&&(s.start(),s.isStart=!0),s.update())}for(const t of e.values())t.onDestroy()}onDestroy(){for(const t of this.nameToComponent.values())t.onDestroy()}get x(){const t=this.style.getPropertyValue("--x");return t?Number(t.replace("px","")):0}set x(t){this.style.setProperty("--x",`${t}px`)}get y(){const t=this.style.getPropertyValue("--y");return t?Number(t.replace("px","")):0}set y(t){this.style.setProperty("--y",`${t}px`)}get rad(){const t=this.style.getPropertyValue("--rad");return t?Number(t.replace("rad","")):0}set rad(t){this.style.setProperty("--rad",`${t}rad`)}get sx(){const t=this.style.getPropertyValue("--sx");return t?Number(t):1}set sx(t){this.style.setProperty("--sx",`${t}`)}get sy(){const t=this.style.getPropertyValue("--sy");return t?Number(t):1}set sy(t){this.style.setProperty("--sy",`${t}`)}get w(){const t=this.style.getPropertyValue("--w");return t?Number(t.replace("px","")):1}set w(t){this.style.setProperty("--w",`${t}px`)}get h(){const t=this.style.getPropertyValue("--h");return t?Number(t.replace("px","")):1}set h(t){this.style.setProperty("--h",`${t}px`)}get bg(){const t=this.style.getPropertyValue("--bg");return t||"black"}set bg(t){this.style.setProperty("--bg",t)}get position(){return new e(this.x,this.y)}set position(t){this.x=t.x,this.y=t.y}get scale(){return new e(this.sx,this.sy)}set scale(t){this.sx=t.x,this.sy=t.y}get parentRad(){return this.radianScreen-this.rad}get parentSx(){return this.scaleScreenX/this.sx}get parentSy(){return this.scaleScreenY/this.sy}get origin(){return this.vertices[n.TYPE_LT].positionScreen.addVectors(this.vertices[n.TYPE_RB].positionScreen).multiply(.5)}get top(){return this.vertices[n.TYPE_LT].positionScreen.addVectors(this.vertices[n.TYPE_RT].positionScreen).multiply(.5)}get bottom(){return this.vertices[n.TYPE_LB].positionScreen.addVectors(this.vertices[n.TYPE_RB].positionScreen).multiply(.5)}get left(){return this.vertices[n.TYPE_LT].positionScreen.addVectors(this.vertices[n.TYPE_LB].positionScreen).multiply(.5)}get right(){return this.vertices[n.TYPE_RT].positionScreen.addVectors(this.vertices[n.TYPE_RB].positionScreen).multiply(.5)}get positionScreen(){return this.origin}set positionScreen(t){let e=t.addVectors(this.positionScreen.multiply(-1));this.translateScreen(e.x,e.y)}get radianScreen(){const t=this.right.addVectors(this.origin.multiply(-1));return Math.atan2(t.y,t.x)}get degreeScreen(){return class{static degToRad(t){return t*(Math.PI/180)}static radToDeg(t){return t/(Math.PI/180)}}.radToDeg(this.radianScreen)}get scaleScreenX(){return this.right.addVectors(this.left.multiply(-1)).distance/this.offsetWidth}get scaleScreenY(){return this.bottom.addVectors(this.top.multiply(-1)).distance/this.offsetHeight}translateScreenX(t){const e=this.parentRad;this.x+=t*Math.cos(-e)*this.parentSx,this.y+=t*Math.sin(-e)*this.parentSy}translateScreenY(t){const e=this.parentRad;this.x+=-t*Math.cos(-(e+Math.PI/2))*this.parentSx,this.y+=-t*Math.sin(-(e+Math.PI/2))*this.parentSy}translateScreen(t,e){const s=this.parentRad;this.x+=(t*Math.cos(-s)-e*Math.cos(-(s+Math.PI/2)))*this.parentSx,this.y+=(t*Math.sin(-s)-e*Math.sin(-(s+Math.PI/2)))*this.parentSx}computeBuffer(){this.bufferVertexPos=[this.vertices[n.TYPE_LT].positionScreen,this.vertices[n.TYPE_RT].positionScreen,this.vertices[n.TYPE_RB].positionScreen,this.vertices[n.TYPE_LB].positionScreen],this.bufferPositionScreen=this.positionScreen,this.bufferRadius=this.radius}get radius(){return this.origin.getDistance(this.vertices[n.TYPE_RT].positionScreen)}get parentNode(){return this.parentNode}calcCollides(){const t=this.bufferVertexPos,s=[t[0].multiply(-1),t[1].multiply(-1),t[2].multiply(-1),t[3].multiply(-1)];for(const n of o.list)if(n!=this&&0==this.collides.includes(n)&&0==this.notCollides.includes(n)){const o=n.bufferVertexPos,r=[o[0].multiply(-1),o[1].multiply(-1),o[2].multiply(-1),o[3].multiply(-1)];let i=!1;if(n.bufferPositionScreen.getDistance(this.bufferPositionScreen)<n.bufferRadius+this.bufferRadius){if(e.isCrossXY(t[0],t[1],o[0],o[1])||e.isCrossXY(t[0],t[1],o[1],o[2])||e.isCrossXY(t[0],t[1],o[2],o[3])||e.isCrossXY(t[0],t[1],o[3],o[0])||e.isCrossXY(t[1],t[2],o[0],o[1])||e.isCrossXY(t[1],t[2],o[1],o[2])||e.isCrossXY(t[1],t[2],o[2],o[3])||e.isCrossXY(t[1],t[2],o[3],o[0])||e.isCrossXY(t[2],t[3],o[0],o[1])||e.isCrossXY(t[2],t[3],o[1],o[2])||e.isCrossXY(t[2],t[3],o[2],o[3])||e.isCrossXY(t[2],t[3],o[3],o[0])||e.isCrossXY(t[3],t[0],o[0],o[1])||e.isCrossXY(t[3],t[0],o[1],o[2])||e.isCrossXY(t[3],t[0],o[2],o[3])||e.isCrossXY(t[3],t[0],o[3],o[0]))i=!0;else{for(const t of s){const s=o[0].addVectors(t),n=o[1].addVectors(t),r=o[2].addVectors(t),a=o[3].addVectors(t),c=e.cross(s,n),u=e.cross(n,r),l=e.cross(r,a),d=e.cross(a,s);if(c*u>0&&u*l>0&&l*d>0&&d*c>0){i=!0;break}}if(0==i)for(const s of r){const n=t[0].addVectors(s),o=t[1].addVectors(s),r=t[2].addVectors(s),a=t[3].addVectors(s),c=e.cross(n,o),u=e.cross(o,r),l=e.cross(r,a),d=e.cross(a,n);if(c*u>0&&u*l>0&&l*d>0&&d*c>0){i=!0;break}}}i?(this.collides.push(n),n.collides.push(this)):(this.notCollides.push(n),n.notCollides.push(this))}}}loopAtScreen(t){const e=t.addVectors(this.origin.multiply(-1)),s=Math.atan2(e.y,e.x),n=this.right.addVectors(this.origin.multiply(-1)),o=Math.atan2(n.y,n.x);this.rad+=s-o}addComponent(e){const s=t.getAttributeName(e);if(s){let t=new e;return t&&(t.entity=this,this.nameToComponent.set(s,t),null==this.attributes.getNamedItem(s)&&this.setAttribute(s,"")),t}}hasComponent(e){const s=t.getAttributeName(e);return!!s&&this.nameToComponent.has(s)}destroy(){s.destoyRecursive(this)}get isInBody(){const t=document.body.getBoundingClientRect(),e=this.positionScreen;return 0<e.x&&e.x<t.width&&0<e.y&&e.y<t.height}get isDestroy(){return null==this.parentElement}}o.list=new Array,customElements.define("m-entity",o);class r{static start(){i.initialize(),this.loop()}static loop(){r.currentFrame=r.currentFrame+1;const t=window.performance.now();r.delta=(t-r.prevDate)/1e3,r.prevDate=t,o.update(),i.update();for(const t of r.loops)t();requestAnimationFrame(r.loop)}static addRequestAnimationFrame(t){r.loops.push(t)}}r.prevDate=window.performance.now(),r.currentFrame=0,r.delta=0,r.loops=[];class i{static initialize(){document.addEventListener("keydown",i._onKeyDown),document.addEventListener("keyup",i._onKeyUp),document.addEventListener("mousemove",i._onMouseMove),document.body.addEventListener("mousedown",i._onMouseDown),document.body.addEventListener("mouseup",i._onMouseUp),document.body.addEventListener("wheel",i._onMouseWheel),i.update()}static update(){for(let t of i.keyToState.keys()){let e=i.keyToState.get(t),s=i.keyToDownFrame.get(t),n=i.keyToUpFrame.get(t);2==e&&s&&s<=r.currentFrame-2?i.keyToState.set(t,1):-1==e&&n&&n<=r.currentFrame-2&&i.keyToState.set(t,0)}i.wheelFrame<r.currentFrame-1&&(i.wheel=0)}static _onKeyDown(t){i.keyToDownFrame.set(t.code,r.currentFrame),i.keyToState.set(t.code,2)}static _onKeyUp(t){i.keyToUpFrame.set(t.code,r.currentFrame),i.keyToState.set(t.code,-1)}static _onMouseMove(t){i.mousePosition=new e(t.clientX,t.clientY)}static _onMouseDown(t){switch(t.button){case 0:i.keyToDownFrame.set(i._MOUSE_LEFT,r.currentFrame),i.keyToState.set(i._MOUSE_LEFT,2);case 1:i.keyToDownFrame.set(i._MOUSE_MIDDLE,r.currentFrame),i.keyToState.set(i._MOUSE_MIDDLE,2);case 2:i.keyToDownFrame.set(i._MOUSE_RIGHT,r.currentFrame),i.keyToState.set(i._MOUSE_RIGHT,2)}}static _onMouseUp(t){switch(t.button){case 0:i.keyToUpFrame.set(i._MOUSE_LEFT,r.currentFrame),i.keyToState.set(i._MOUSE_LEFT,-1);case 1:i.keyToUpFrame.set(i._MOUSE_MIDDLE,r.currentFrame),i.keyToState.set(i._MOUSE_MIDDLE,-1);case 2:i.keyToUpFrame.set(i._MOUSE_RIGHT,r.currentFrame),i.keyToState.set(i._MOUSE_RIGHT,-1)}}static _onMouseWheel(t){i.wheelFrame=r.currentFrame,i.wheel=t.deltaY}static isUp(t){return!!i.keyToState.has(t)&&-1==i.keyToState.get(t)}static isNotPress(t){const e=i.keyToState.get(t);return 0==e||-1==e}static isDown(t){return 2==i.keyToState.get(t)}static isPressing(t){const e=i.keyToState.get(t);return 1==e||2==e}static get isUpMouseLeft(){return-1==i.keyToState.get(i._MOUSE_LEFT)}static get isNotPressMouseLeft(){const t=i.keyToState.get(i._MOUSE_LEFT);return-1==t||0==t}static get isDownMouseLeft(){return 2==i.keyToState.get(i._MOUSE_LEFT)}static get isPressingMouseLeft(){const t=i.keyToState.get(i._MOUSE_LEFT);return 1==t||2==t}static get isUpMouseRight(){return-1==i.keyToState.get(i._MOUSE_RIGHT)}static get isNotPressMouseRight(){const t=i.keyToState.get(i._MOUSE_RIGHT);return-1==t||0==t}static get isDownMouseRight(){return 2==i.keyToState.get(i._MOUSE_RIGHT)}static get isPressingMouseRight(){const t=i.keyToState.get(i._MOUSE_RIGHT);return 1==t||2==t}static get isUpMouseMiddle(){return-1==i.keyToState.get(i._MOUSE_MIDDLE)}static get isNotPressMouseMiddle(){const t=i.keyToState.get(i._MOUSE_MIDDLE);return-1==t||0==t}static get isDownMouseMiddle(){return 2==i.keyToState.get(i._MOUSE_MIDDLE)}static get isPressingMouseMiddle(){const t=i.keyToState.get(i._MOUSE_MIDDLE);return 1==t||2==t}}i._MOUSE_LEFT="_MOUSE_LEFT",i._MOUSE_RIGHT="_MOUSE_RIGHT",i._MOUSE_MIDDLE="_MOUSE_MIDDLE",i.keyToState=new Map,i.keyToDownFrame=new Map,i.keyToUpFrame=new Map,i.mousePosition=new e(0,0),i.wheelFrame=0,i.wheel=0;class a extends t{static generate(t,e){const s=o.generate();return s.rad=e,s.w=10,s.h=10,s.bg="red",s.positionScreen=t,s.addComponent(a)}update(){const t=this.entity,e=t.right.addVectors(t.origin.multiply(-1));t.position=t.position.addVectors(e.normalized.multiply(500).multiply(r.delta)),0==t.isInBody&&t.destroy()}}class c extends t{constructor(){super(...arguments),this.interval=0}update(){if(this.interval>0&&(this.interval-=r.delta),i.isDownMouseLeft&&this.interval<=0){const t=this.entity.positionScreen,e=this.entity.radianScreen;a.generate(t,e),this.interval=c.SPAN}}}c.SPAN=.4;class u extends t{static generate(){const t=o.generate(),s=document.body.offsetWidth,n=document.body.offsetHeight;t.w=50,t.h=50,t.positionScreen=new e(s/2,n/2),u.instance=t.addComponent(u);const r=o.generate();t.appendChild(r),r.w=25,r.h=25,r.x=37.5,r.y=12.5,r.addComponent(c)}update(){const e=r.delta,s=this.entity;i.isPressing("KeyW")&&s.translateScreenY(500*-e),i.isPressing("KeyA")&&s.translateScreenX(500*-e),i.isPressing("KeyS")&&s.translateScreenY(500*e),i.isPressing("KeyD")&&s.translateScreenX(500*e),s.loopAtScreen(i.mousePosition);const n=document.body.offsetWidth,o=document.body.offsetHeight,a=s.positionScreen;let c=!1;a.x<0?(a.x=0,c=!0):a.x>n&&(a.x=n,c=!0),a.y<0?(a.y=0,c=!0):a.y>o&&(a.y=o,c=!0),c&&(s.positionScreen=a);const u=t.getAttributeName(l);u&&s.collides.some((t=>t.attributes.getNamedItem(u)))&&(s.destroy(),W.toEndingState())}}u.instance=void 0;class l extends t{static generate(){const t=o.generate();let s=null;const n=document.body.clientWidth,r=document.body.clientHeight;return s=Math.random()>.5?Math.random()>.75?new e(-l.WIDTH,Math.random()*r):new e(n+l.WIDTH,Math.random()*r):Math.random()>.25?new e(Math.random()*n,-l.HEIGHT):new e(Math.random()*n,r+l.WIDTH),t.w=l.WIDTH,t.h=l.HEIGHT,t.positionScreen=s,t.bg="blue",t.addComponent(l)}static destroyAll(){for(const t of o.list)t.hasComponent(l)&&t.destroy()}update(){const e=u.instance,s=this.entity;if(e&&0==e.entity.isDestroy){this.entity.loopAtScreen(e.entity.positionScreen);const t=s.right.addVectors(s.origin.multiply(-1));s.position=s.position.addVectors(t.normalized.multiply(50).multiply(r.delta))}const n=t.getAttributeName(a);if(n){const t=s.collides.find((t=>t.attributes.getNamedItem(n)));t&&(W.score+=1,t.destroy(),s.destroy())}}}function d(){}function h(t){return t()}function p(){return Object.create(null)}function y(t){t.forEach(h)}function m(t){return"function"==typeof t}function g(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function f(t,e){t.appendChild(e)}function T(t,e,s){t.insertBefore(e,s||null)}function S(t){t.parentNode.removeChild(t)}function _(t){return document.createElement(t)}function E(t){return document.createTextNode(t)}function M(){return E(" ")}let x;function P(t){x=t}function w(t){(function(){if(!x)throw new Error("Function called outside component initialization");return x})().$$.on_mount.push(t)}l.WIDTH=100,l.HEIGHT=100;const b=[],D=[],C=[],k=[],v=Promise.resolve();let Y=!1;function I(t){C.push(t)}let L=!1;const N=new Set;function F(){if(!L){L=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];P(e),R(e.$$)}for(P(null),b.length=0;D.length;)D.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];N.has(e)||(N.add(e),e())}C.length=0}while(b.length);for(;k.length;)k.pop()();Y=!1,L=!1,N.clear()}}function R(t){if(null!==t.fragment){t.update(),y(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const U=new Set;function $(t,e){-1===t.$$.dirty[0]&&(b.push(t),Y||(Y=!0,v.then(F)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function A(t,e,s,n,o,r,i=[-1]){const a=x;P(t);const c=t.$$={fragment:null,ctx:null,props:r,update:d,not_equal:o,bound:p(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:e.context||[]),callbacks:p(),dirty:i,skip_bound:!1};let u=!1;if(c.ctx=s?s(t,e.props||{},((e,s,...n)=>{const r=n.length?n[0]:s;return c.ctx&&o(c.ctx[e],c.ctx[e]=r)&&(!c.skip_bound&&c.bound[e]&&c.bound[e](r),u&&$(t,e)),s})):[],c.update(),u=!0,y(c.before_update),c.fragment=!!n&&n(c.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);c.fragment&&c.fragment.l(t),t.forEach(S)}else c.fragment&&c.fragment.c();e.intro&&((l=t.$$.fragment)&&l.i&&(U.delete(l),l.i(g))),function(t,e,s,n){const{fragment:o,on_mount:r,on_destroy:i,after_update:a}=t.$$;o&&o.m(e,s),n||I((()=>{const e=r.map(h).filter(m);i?i.push(...e):y(e),t.$$.on_mount=[]})),a.forEach(I)}(t,e.target,e.anchor,e.customElement),F()}var l,g;P(a)}function V(t){let e;return{c(){e=E("スペース：最初から")},m(t,s){T(t,e,s)},d(t){t&&S(e)}}}function O(t){let e;return{c(){e=E("敵を撃て！")},m(t,s){T(t,e,s)},d(t){t&&S(e)}}}function H(t){let e;return{c(){e=E("スペース: ゲーム開始")},m(t,s){T(t,e,s)},d(t){t&&S(e)}}}function G(t){let e,s,n,o,r,i,a,c,u,l,h,p,y,m=t[0].score+"";function g(t,e){return t[0].isStateWaiting?H:t[0].isStatePlaying?O:V}let x=g(t),P=x(t);return{c(){e=_("div"),s=_("h1"),s.textContent="DOM Shooting Game",n=M(),o=_("p"),r=E("スコア: "),i=E(m),a=M(),c=_("p"),c.innerHTML="WASD : 移動<br/>\n\t\tマウス移動 : 回転<br/>\n\t\t左クリック : 弾発射<br/>",u=M(),l=_("p"),h=_("b"),P.c(),p=M(),y=_("p"),y.innerHTML='<a href="/">ミニゲー</a>'},m(t,d){T(t,e,d),f(e,s),f(e,n),f(e,o),f(o,r),f(o,i),f(e,a),f(e,c),f(e,u),f(e,l),f(l,h),P.m(h,null),f(e,p),f(e,y)},p(t,[e]){1&e&&m!==(m=t[0].score+"")&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(i,m),x!==(x=g(t))&&(P.d(1),P=x(t),P&&(P.c(),P.m(h,null)))},i:d,o:d,d(t){t&&S(e),P.d()}}}function X(t,e,s){return w((()=>{})),[W,()=>{s(0,W)}]}class B extends class{$destroy(){!function(t,e){const s=t.$$;null!==s.fragment&&(y(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}(this,1),this.$destroy=d}$on(t,e){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),A(this,t,X,G,g,{reload:1})}get reload(){return this.$$.ctx[1]}}class W{static get state(){return W._state}static set state(t){var e;W._state=t,null===(e=W.view)||void 0===e||e.reload()}static get score(){return W._score}static set score(t){var e;W._score=t,null===(e=W.view)||void 0===e||e.reload()}static initialize(){r.start(),t.registerComponent("player",u),t.registerComponent("gun",c),t.registerComponent("bullet",a),t.registerComponent("enemy",l),W.view=new B({target:document.body}),u.generate(),W.generateSpan=W._GENERATE_SPAN_DEFAULT,W.generateTime=W.generateSpan,r.addRequestAnimationFrame(W.loop)}static loop(){i.isDown("Space")&&0==W.isStatePlaying&&W.toPlayingState();u.instance&&W.isStatePlaying&&(W.generateTime+=r.delta,W.generateTime>W.generateSpan&&(l.generate(),W.generateTime=0,W.generateSpan=Math.max(W.generateSpan-.2,.99*c.SPAN)))}static get isStateWaiting(){return W.state==W._STATE_WAITING}static get isStatePlaying(){return W.state==W._STATE_PLAYING}static get isStateEnding(){return W.state==W._STATE_ENDING}static toPlayingState(){l.destroyAll(),(null==u.instance||u.instance.entity.isDestroy)&&u.generate(),W.generateTime=0,W.state=W._STATE_PLAYING}static toEndingState(){W.state=W._STATE_ENDING}}W._STATE_WAITING=0,W._STATE_PLAYING=1,W._STATE_ENDING=2,W._GENERATE_SPAN_DEFAULT=3,W.view=void 0,W.generateTime=0,W.generateSpan=W._GENERATE_SPAN_DEFAULT,W._state=W._STATE_WAITING,W._score=0,W.initialize()}();
//# sourceMappingURL=bundle.js.map
